{"version":3,"sources":["../../../../src/lib/app/appServer/appServer.js"],"names":["persistentState","restore","createAppServer","app","use","post","json","get","serveAppServer","port","cb","listen","console","log","green"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,kBAAkB,yCAAxB;AACAA,gBAAgBC,OAAhB;;AAEO,IAAMC,4CAAkB,SAAlBA,eAAkB,GAAM;AACnC,MAAMC,MAAM,wBAAZ;AACAA,MAAIC,GAAJ,CAAQ,qBAAR;;AAEAD,MAAIE,IAAJ,CAAS,aAAT,EAAwB,qBAAWC,IAAX,EAAxB,EAA2C,iDAA3C;AACAH,MAAIE,IAAJ,CAAS,gBAAT,EAA2B,qBAAWC,IAAX,EAA3B,EAA8C,oDAA9C;AACAH,MAAIE,IAAJ,CAAS,eAAT,EAA0B,qBAAWC,IAAX,EAA1B,EAA6C,mDAA7C;AACAH,MAAIE,IAAJ,CAAS,cAAT,EAAyB,qBAAWC,IAAX,EAAzB,EAA4C,kDAA5C;AACAH,MAAIE,IAAJ,CAAS,cAAT,EAAyB,qBAAWC,IAAX,EAAzB,EAA4C,kDAA5C;AACAH,MAAIE,IAAJ,CAAS,gBAAT,EAA2B,qBAAWC,IAAX,EAA3B;AACAH,MAAIE,IAAJ,CAAS,mBAAT,EAA8B,qBAAWC,IAAX,EAA9B,EAAiD,uDAAjD;AACAH,MAAII,GAAJ,CAAQ,SAAR,EAAmB,iCAAnB;AACAJ,MAAII,GAAJ,CAAQ,YAAR,EAAsB,oDAAtB;AACAJ,MAAII,GAAJ,CAAQ,QAAR,EAAkB,mCAAlB;AACAJ,MAAIE,IAAJ,CAAS,SAAT,EAAoB,qBAAWC,IAAX,EAApB,EAAuC,8CAAvC;;AAEA,SAAOH,GAAP;AACD,CAjBM;;AAmBA,IAAMK,0CAAiB,SAAjBA,cAAiB,CAACC,IAAD,EAAOC,EAAP,EAAc;AAC1CR,oBAAkBS,MAAlB,CAAyBF,IAAzB,EAA+B,YAAM;AACnC;AACAG,YAAQC,GAAR,CAAY,eAAOC,KAAP,oCAA8CL,IAA9C,CAAZ;AACA,QAAI,OAAOC,EAAP,KAAc,UAAlB,EAA8B;AAC5BA;AACD;AACF,GAND;AAOD,CARM","file":"appServer.js","sourcesContent":["import express from 'express';\nimport bodyParser from 'body-parser';\nimport cors from 'cors';\nimport colors from 'colors/safe';\nimport configureAddServerMiddleware from './middlewares/addServerMiddleware';\nimport configureRemoveServerMiddleware from './middlewares/removeServerMiddleware';\nimport configureStartServerMiddleware from './middlewares/startServerMiddleware';\nimport configureStopServerMiddleware from './middlewares/stopServerMiddleware';\nimport configureEditServerMiddleware from './middlewares/editServerMiddleware';\nimport addBehaviourMiddleware from './middlewares/addBehaviourMiddleware';\nimport configureRemoveBehaviourMiddleware from './middlewares/removeBehaviourMiddleware';\nimport configureExportMiddleware from './middlewares/exportMiddleware';\nimport configureGetBehaviourMiddleware from './middlewares/getBehaviourMiddleware';\nimport configurePersistentState from './configurePersistentState';\nimport configureGetStateMiddleware from './middlewares/getStateMiddleware';\nimport configureImportMiddleware from './middlewares/importMiddleware';\nimport ajv from './ajv';\n\nconst persistentState = configurePersistentState();\npersistentState.restore();\n\nexport const createAppServer = () => {\n  const app = express();\n  app.use(cors());\n\n  app.post('/add-server', bodyParser.json(), configureAddServerMiddleware(ajv));\n  app.post('/remove-server', bodyParser.json(), configureRemoveServerMiddleware(ajv));\n  app.post('/start-server', bodyParser.json(), configureStartServerMiddleware(ajv));\n  app.post('/stop-server', bodyParser.json(), configureStopServerMiddleware(ajv));\n  app.post('/edit-server', bodyParser.json(), configureEditServerMiddleware(ajv));\n  app.post('/add-behaviour', bodyParser.json(), addBehaviourMiddleware);\n  app.post('/remove-behaviour', bodyParser.json(), configureRemoveBehaviourMiddleware(ajv));\n  app.get('/export', configureExportMiddleware());\n  app.get('/behaviour', configureGetBehaviourMiddleware(ajv));\n  app.get('/state', configureGetStateMiddleware());\n  app.post('/import', bodyParser.json(), configureImportMiddleware(ajv));\n\n  return app;\n};\n\nexport const serveAppServer = (port, cb) => {\n  createAppServer().listen(port, () => {\n    // eslint-disable-next-line no-console\n    console.log(colors.green(`App address: http://127.0.0.1:${port}`));\n    if (typeof cb === 'function') {\n      cb();\n    }\n  });\n};\n"]}